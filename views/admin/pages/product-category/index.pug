extends ../../layouts/default.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/form-change-multi.pug
include ../../mixins/alert.pug
include ../../mixins/sort.pug

block main
    if(role.permissions.includes("products-category_view")) 
        +alert-success(5000)
        +alert-error(5000)

        .container.mb-5
            h1.display-4.text-center Danh muc san pham

        .card.mb-3 
            .card-header Bo loc va tim kiem 
            .card-body 
                .row.align-items-center.justify-content-between
                    .col-3
                        +filter-status(filterStatus)
                    .col-3   
                        +sort(sort)
                    .col-4
                        +search(keyword)  

        .card.mb-3 
            .card-header Danh muc
            .card-body
                .row
                    .col-8
                        if(role.permissions.includes("products-category_edit"))
                            +form-change-multi(`${prefixAdmin}/product-category/change-multi?_method=PATCH`)
                    .col-4
                        if(role.permissions.includes("products-category_create")) 
                            a(
                                href=`${prefixAdmin}/product-category/create`
                                class="btn btn-outline-success"
                            ) + Them moi

                table(class="table table-hover table-sm" checkbox-multi)
                    thead  
                        tr
                            th 
                                input(type="checkbox" name="checkAll")
                            th STT 
                            th Hinh anh 
                            th Tieu de  
                            th Vi tri
                            th Trang thai 
                            th Hanh dong
                    tbody
                        each item, index in records
                            tr 
                                td 
                                    input(type="checkbox" name="id" value=item.id)
                                td #{pagination.limitItems * (pagination.currentPage - 1) + index + 1}
                                td 
                                    img(src=item.thumbnail, alt=item.title, width="100px", height="auto")
                                td #{item.title}
                                td
                                    input(
                                        type="number"
                                        value=item.position
                                        style="width: 60px"
                                        min="1"
                                        name="position"
                                    )
                                td
                                    if(role.permissions.includes("products-category_edit"))   
                                        if(item.status == "active") 
                                            a(href="javascript:", button-change-status, data-status=item.status, data-id=item.id, class="badge badge-success") Hoat dong 
                                        else    
                                            a(href="javascript:", button-change-status, data-status=item.status, data-id=item.id, class="badge badge-danger") Dung hoat dong
                                    else 
                                        if(item.status == "active")
                                            button( 
                                                class="badge badge-success" 
                                                data-status=item.status
                                                data-id=item.id
                                            ) Hoạt động
                                        else
                                            button(
                                                class="badge badge-danger" 
                                                data-status=item.status
                                                data-id=item.id
                                            ) Dừng hoạt động
                                td 
                                    a(
                                        href=`${prefixAdmin}/product-category/detail/${item.id}`
                                        class="btn btn-secondary btn-sm"
                                    ) Chi tiet
                                    if(role.permissions.includes("products-category_edit"))
                                        a(
                                            href=`${prefixAdmin}/product-category/edit/${item.id}`
                                            class="btn btn-warning btn-sm"
                                        ) Sua
                                    if(role.permissions.includes("products-category_delete"))
                                        button(class="btn btn-danger btn-sm ml-1" data-id=item.id button-delete) Xoa

        +pagination(pagination)

        form(action="" method="POST" id="form-change-status" data-path=`${prefixAdmin}/product-category/change-status`) 

        form(action="" method="POST" id="form-delete-item" data-path=`${prefixAdmin}/product-category/delete`)

        script(src="/admin/js/product.js")
                    



